"""Test the Consensus class."""
import sys
import unittest
try:
    from StringIO import StringIO
except ImportError:
    from io import StringIO
import pyngs.interval
import pyngs.alignment


class ConsensusTest(unittest.TestCase):
    
    def setUp(self):
        """Prepare data and variables for test cases."""
        self.samlines = """D00510:443:HMYNJBCXY:2:1202:14537:29544:X:CTGACAAGCGCAA 83 chr17 7572964 60 19S55M = 7572965 -54 ACAAGCGCAATTGGAGTCCTTTTTATGGCGGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGAGA IIIIHIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIHIIIIIIIIIIIIIIIIIHIIIIIIIIIIIHDDDDD NM:i:0 MD:Z:55 AS:i:55 XS:i:0 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01
D00510:443:HMYNJBCXY:2:2212:18760:35285:X:CTGACAAGCGCAA 83 chr17 7572964 60 19S55M = 7572965 -54 ACAAGCGCAATTGGAGTCCTTTTTATGGCGGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGAAA
 IIIIIIIIIIIIIIHIHIIHIIIIIIIIIIIIIIIIIIHIHIIIIIIIIIIIIIIIIIIIIIIIIIIHHDD<0D NM:i:1 MD:Z:53G1 AS:i:53 XS:i:0 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01
D00510:443:HMYNJBCXY:1:2105:1650:22168:X:CTGACAAGCGCAA 83 chr17 7572964 60 19S55M = 7572965 -54 ACAAGCGCAATTGGAGTCCTTTTTATGGCAGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGAGA
 HIHIIIIIIIHGHIHH?IHHHHHIIHHHG?IIIIIIIIIIIIIIIIHIIIGIHHIHIIIIIIIIIHHHHDDDD@ NM:i:1 MD:Z:10G44 AS:i:50 XS:i:19 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01-65323EF0
D00510:443:HMYNJBCXY:1:2114:10069:32223:X:CTGACAAGCGCAA 83 chr17 7572964 60 19S55M = 7572965 -54 ACAAGCGCAATTGGAGTCCTTTTTATGGCGGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGGGA
 H@@?HGHG1F<1HGHGCEE@EHHGEDCC<?IHCEHIIHEIIHDE0@@D1GCFEHCIHE@FIHIHFHFCD@D<0D NM:i:1 MD:Z:52A2 AS:i:52 XS:i:0 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01-65323EF0
D00510:443:HMYNJBCXY:2:1202:14537:29544:X:CTGACAAGCGCAA 163 chr17 7572965 60 56M19S = 7572964 54 TTTTATGGCGGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGAGACAAAACGCAATACTGTACATT DHHIIIIIIIIIIIIHHHIHHHHIIIIIIIIDHGHHIHHCHHFHEFHHHHIFFEHHIIIHHHHIEHHHHIGHIHI NM:i:0 MD:Z:56 AS:i:56 XS:i:0 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01
D00510:443:HMYNJBCXY:2:2212:18760:35285:X:CTGACAAGCGCAA 163 chr17 7572965 60 56M19S = 7572964 54 TTTTATGGCGGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGAGACAAAACGCAATACTGTACATT CGHHHHHHIIIICHH@GHGCCHHHIIHIIIIIIGIIIGHHIEHIHIEGHIICGEEEHIIHHHGHHIGEHHHFHII NM:i:0 MD:Z:56 AS:i:56 XS:i:0 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01
D00510:443:HMYNJBCXY:1:2105:1650:22168:X:CTGACAAGCGCAA 163 chr17 7572965 60 56M19S = 7572964 54 TTTTATGGCAGGAGGTAGACTGACCCTTTTTGGACTTCAGGTGGCTGTAGGAGACAAAACGCAATACTGTACATT <GHHEGHFH?GHIIIHHHIIHFHHIIFHFHIHHHIIIIIHHHIIIHEHFGHHIIHIIIIIIIHIIIIIIIHIIEH NM:i:1 MD:Z:9G46 AS:i:51 XS:i:19 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01-65323EF0
D00510:443:HMYNJBCXY:1:2114:10069:32223:X:CTGACAAGCGCAA 163 chr17 7572965 60 56M19S = 7572964 54 TTATATGGCGGGAGGGAGACTGACCCTTTTTTGACTTCAGGTGGCTGTAGGAGACAAAACGCAATACTGTACATT <<<<ECHEH<C<//</0<C1<DG?GHEHIII/<0<DH<?1D11<C<1<1<<1111<FHHC?///<DFH?G111DC NM:i:3 MD:Z:2T12T15G24 AS:i:43 XS:i:0 um:Z:CTGACAAGCGCAA wb:Z:X RG:Z:I17-1255-01-65323EF0
""".split("\n")
        self.consensus_alignments = """A 0 1 1003 60 3S3M1I6M1D4M * 0 0 NNNAACTAAAAAATAAA IIIIIIIIIIIIIIIII
B 0 1 1005 60 1M1I10M2S * 0 0 CTAAAAAAGTCANN IIIIIIIIIIII??
B1 0 1 1005 60 1M10M * 0 0 CAAAAAAGTAA IIIIIIIIIII
C 0 1 1012 60 10M4S * 0 0 GTAAAAAAAANNNN IIIIIIIIII????""".split("\n")

    def test_consensus(self):
        """Test the consensus."""
        factory = pyngs.alignment.SAMParser(chromosome_list=["1"])
        alignments = [factory.from_string(line, sep=" ") for line in self.consensus_alignments]

        sys.stderr.write("\n")
        consensus = pyngs.alignment.Consensus()
        conseq = consensus(alignments)
        sys.stderr.write("{x}\n".format(x=conseq))

